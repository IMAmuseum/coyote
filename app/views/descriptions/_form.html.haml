= simple_form_for @description, validate: true, html: {multipart: true, class: 'form-horizontal'}, wrapper: :horizontal_form, wrapper_mappings: { check_boxes: :horizontal_radio_and_checkboxes, radio_buttons: :horizontal_radio_and_checkboxes, file: :horizontal_file_input} do |f|
  = f.error_notification
  .form-inputs
    - if @image
      .row
        .col-sm-9.col-sm-push-3
          = f.input :image_id,  as: :hidden, input_html: {value: @image.id}
          = image_tag  @image.url, class: "description-image"
    - else
      = f.association :image,  :selected => params[:image_id]
    - if @author.nil?
      = f.association :user, label: "Author", prompt: "Pick the author"
    - elsif action_name == 'new' and 
      = f.input :user_id,  as: :hidden, input_html: {value: @author.id}
    = f.association :metum, prompt: "Choose the description type", prompt: "Pick the description type"
    = f.input :locale, collection: LanguageList::COMMON_LANGUAGES, :label_method => :name,:value_method => :iso_639_1, as: :select, prompt: "Pick the locale", selected: "en"
    - if admin?
      = f.association :status, prompt: "Pick the status"
    - else
      = f.input :status_id, as: :hidden, input_html: {value: 1}
    = f.input :text #TODO update prompt based on metum and user
    .row
      .col-md-9.col-md-push-3
        - @meta.each do |m|
          - if @description.metum_id == m.id
            - style = 'display: block;'
          -else
            - style = 'display: none;'
          - klass = 'metum-instructions'
          %p{id: "metum-instructions-#{m.id}", style: style}
            =m.instructions



  .form-actions
    .form-actions-inner
      = f.button :submit, class: 'btn btn-success'
      - if action_name == 'edit'
        %br
        %br
        = link_to @description, class: 'btn btn-info' do
          %i.fa.fa-fw.fa-eye{title: "Eye"}
          View this description
      %br
      %br
      = link_to descriptions_path, class: 'btn btn-info' do
        %i.fa.fa-fw.fa-list{title: "List"}
        View all Descriptions
